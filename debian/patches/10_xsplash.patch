#
# Description: Load xsplash on login
# Ubuntu: https://wiki.ubuntu.com/DesktopTeam/Specs/Karmic/LoginExperience
#
=== modified file 'data/Init.in'
diff -Nur -x '*.orig' -x '*~' gdm-2.27.4/data/Init.in gdm-2.27.4.new/data/Init.in
--- gdm-2.27.4/data/Init.in	2009-05-19 17:18:12.000000000 +0200
+++ gdm-2.27.4.new/data/Init.in	2009-08-11 19:09:36.000000000 +0200
@@ -6,6 +6,11 @@
 PATH=@X_PATH@:$PATH
 OLD_IFS=$IFS
 
+#if [ -x '/usr/bin/xsplash' ];
+#then
+#        /usr/bin/xsplash --gdm-session --daemon
+#fi
+
 gdmwhich () {
   COMMAND="$1"
   OUTPUT=
diff -Nur -x '*.orig' -x '*~' gdm-2.27.4/data/PreSession.in gdm-2.27.4.new/data/PreSession.in
--- gdm-2.27.4/data/PreSession.in	2009-05-19 17:18:12.000000000 +0200
+++ gdm-2.27.4.new/data/PreSession.in	2009-08-11 19:09:36.000000000 +0200
@@ -7,3 +7,9 @@
 # Note that output goes into the .xsession-errors file for easy debugging
 #
 PATH="@X_PATH@:$PATH:/bin:/usr/bin"
+
+#if [ -x '/usr/bin/xsplash' ];
+#then
+#        /usr/bin/xsplash --daemon
+#fi
+
diff -Nur -x '*.orig' -x '*~' gdm-2.27.4/gui/simple-greeter/gdm-greeter-session.c gdm-2.27.4.new/gui/simple-greeter/gdm-greeter-session.c
--- gdm-2.27.4/gui/simple-greeter/gdm-greeter-session.c	2009-07-20 03:06:16.000000000 +0200
+++ gdm-2.27.4.new/gui/simple-greeter/gdm-greeter-session.c	2009-08-11 19:09:40.000000000 +0200
@@ -426,6 +426,13 @@
         toggle_panel (session, TRUE);
         toggle_login_window (session, TRUE);
 
+        g_spawn_command_line_async ("dbus-send "
+                                    "--system --type=method_call "
+                                    "--dest=com.ubuntu.BootCurtain "
+                                    "/com/ubuntu/BootCurtain "
+                                    "com.ubuntu.BootCurtain.SignalLoaded string:gdm",
+                                    NULL);
+
         gdm_profile_end (NULL);
 
         return res;
